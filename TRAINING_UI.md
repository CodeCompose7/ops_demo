# ğŸ¯ Training Controller UI ê°€ì´ë“œ

ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ í´ë¦­ë§Œìœ¼ë¡œ ëª¨ë¸ í›ˆë ¨ì„ ì‹œì‘í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” UIì…ë‹ˆë‹¤!

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

- ğŸš€ **ì›¹ UIì—ì„œ í›ˆë ¨ ì‹œì‘** - í„°ë¯¸ë„ ëª…ë ¹ì–´ ì—†ì´ ë¸Œë¼ìš°ì €ì—ì„œ í´ë¦­ë§Œìœ¼ë¡œ í›ˆë ¨ ì‹œì‘
- ğŸ“Š **ì‹¤ì‹œê°„ Job ëª¨ë‹ˆí„°ë§** - ì‹¤í–‰ ì¤‘ì¸ í›ˆë ¨ Jobì˜ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸
- ğŸ›ï¸ **í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„¤ì •** - ì§ê´€ì ì¸ í¼ìœ¼ë¡œ `n_estimators`, `max_depth` ì¡°ì •
- ğŸ·ï¸ **ì‹¤í—˜ ì´ë¦„ ê´€ë¦¬** - MLflowì™€ ì—°ë™ë˜ëŠ” ì‹¤í—˜ ì´ë¦„ ì„¤ì •
- ğŸ”„ **ìë™ ìƒˆë¡œê³ ì¹¨** - 5ì´ˆë§ˆë‹¤ Job ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. í™˜ê²½ ë°°í¬ (ì²˜ìŒ í•œ ë²ˆë§Œ)

```bash
cd /app
./k8s/deploy.sh
```

ì´ ëª…ë ¹ì–´ë¡œ ë‹¤ìŒì´ ìë™ ë°°í¬ë©ë‹ˆë‹¤:
- âœ… Training Controller UI
- âœ… MLflow Server
- âœ… Serving API

### 2. UI ì ‘ì†

```bash
# í¬íŠ¸í¬ì›Œë”©
kubectl port-forward -n mlops-training \
  $(kubectl get pod -n mlops-training -l app=training-controller -o jsonpath='{.items[0].metadata.name}') \
  8080:8080
```

ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†: **http://localhost:8080**

---

## ğŸ–¥ï¸ UI ì‚¬ìš©ë²•

### ë©”ì¸ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ğŸš€ ML Training Controller              â”‚
â”‚    Kubernetesì—ì„œ ëª¨ë¸ í›ˆë ¨ì„ ì‰½ê²Œ        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ“Š MLflow UI] [ğŸ”¥ Serving API] [ğŸ“– Docs] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¯ ìƒˆë¡œìš´ í›ˆë ¨ ì‹œì‘  â”‚ ğŸ“‹ ì‹¤í–‰ ì¤‘ì¸ Job    â”‚
â”‚                     â”‚                     â”‚
â”‚ ğŸŒ³ íŠ¸ë¦¬ ê°œìˆ˜        â”‚ iris-training-...   â”‚
â”‚   [100___]          â”‚ â— Running           â”‚
â”‚                     â”‚ ìƒì„±: 2025-01-15... â”‚
â”‚ ğŸ“ ìµœëŒ€ ê¹Šì´        â”‚                     â”‚
â”‚   [5_____]          â”‚ iris-training-...   â”‚
â”‚                     â”‚ âœ“ Succeeded         â”‚
â”‚ ğŸ·ï¸ ì‹¤í—˜ ì´ë¦„        â”‚ ìƒì„±: 2025-01-15... â”‚
â”‚   [experiment-001_] â”‚                     â”‚
â”‚                     â”‚ [ğŸ”„ ìƒˆë¡œê³ ì¹¨]       â”‚
â”‚ [ğŸš€ í›ˆë ¨ ì‹œì‘]      â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1. í›ˆë ¨ ì‹œì‘í•˜ê¸°

1. **íŠ¸ë¦¬ ê°œìˆ˜ (n_estimators)** ì…ë ¥
   - ê¶Œì¥: 100-300
   - ë§ì„ìˆ˜ë¡ ì •í™•ë„ â†‘, í›ˆë ¨ ì‹œê°„ â†‘

2. **ìµœëŒ€ ê¹Šì´ (max_depth)** ì…ë ¥
   - ê¶Œì¥: 5-20
   - í´ìˆ˜ë¡ ë³µì¡í•œ íŒ¨í„´ í•™ìŠµ, ê³¼ì í•© ìœ„í—˜ â†‘

3. **ì‹¤í—˜ ì´ë¦„ (ì„ íƒ)** ì…ë ¥
   - ë¹„ì›Œë‘ë©´ ìë™ ìƒì„±: `training-20250115-143022`
   - ì˜ˆ: `experiment-001`, `baseline`, `optimized-v2`

4. **"ğŸš€ í›ˆë ¨ ì‹œì‘"** ë²„íŠ¼ í´ë¦­

### 2. Job ìƒíƒœ í™•ì¸

ì‹¤í–‰ ì¤‘ì¸ Jobì€ ìë™ìœ¼ë¡œ ì˜¤ë¥¸ìª½ íŒ¨ë„ì— í‘œì‹œë©ë‹ˆë‹¤:

| ìƒíƒœ | í‘œì‹œ | ì˜ë¯¸ |
|------|------|------|
| **Pending** | ğŸ”µ | Jobì´ ì‹œì‘ ëŒ€ê¸° ì¤‘ |
| **Running** | ğŸŸ¡ (ê¹œë¹¡ì„) | í›ˆë ¨ ì‹¤í–‰ ì¤‘ |
| **Succeeded** | ğŸŸ¢ | í›ˆë ¨ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œ |
| **Failed** | ğŸ”´ | í›ˆë ¨ ì‹¤íŒ¨ |

**ìë™ ìƒˆë¡œê³ ì¹¨:** 5ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.

---

## ğŸ“Š MLflowì™€ ì—°ë™

Training Controllerì—ì„œ ì‹œì‘í•œ ëª¨ë“  í›ˆë ¨ì€ ìë™ìœ¼ë¡œ MLflowì— ê¸°ë¡ë©ë‹ˆë‹¤.

### MLflow UI ì ‘ì†

```bash
# í„°ë¯¸ë„ 2
kubectl port-forward -n mlops-training \
  $(kubectl get pod -n mlops-training -l app=mlflow-server -o jsonpath='{.items[0].metadata.name}') \
  5000:5000
```

ë¸Œë¼ìš°ì €: **http://localhost:5000**

### í™•ì¸ ê°€ëŠ¥í•œ ì •ë³´

- ğŸ“ˆ **ë©”íŠ¸ë¦­:** accuracy, f1_score, precision, recall
- ğŸ›ï¸ **íŒŒë¼ë¯¸í„°:** n_estimators, max_depth, random_state
- ğŸ·ï¸ **íƒœê·¸:** ì‹¤í—˜ ì´ë¦„, ì•Œê³ ë¦¬ì¦˜, ë°ì´í„°ì…‹
- ğŸ’¾ **ì•„í‹°íŒ©íŠ¸:** í›ˆë ¨ëœ ëª¨ë¸ íŒŒì¼

---

## ğŸ”— API ì§ì ‘ í˜¸ì¶œ

ì›¹ UI ëŒ€ì‹  APIë¥¼ ì§ì ‘ í˜¸ì¶œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

### API ë¬¸ì„œ í™•ì¸

```bash
# í¬íŠ¸í¬ì›Œë”© í›„
# http://localhost:8080/docs
```

### í›ˆë ¨ ì‹œì‘ (POST)

```bash
curl -X POST http://localhost:8080/jobs/train \
  -H "Content-Type: application/json" \
  -d '{
    "n_estimators": 200,
    "max_depth": 20,
    "run_name": "api-experiment"
  }'
```

**ì‘ë‹µ:**
```json
{
  "job_name": "iris-training-20250115-143022",
  "run_name": "api-experiment",
  "status": "Created",
  "parameters": {
    "n_estimators": 200,
    "max_depth": 20
  },
  "message": "í›ˆë ¨ Jobì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

### Job ëª©ë¡ ì¡°íšŒ (GET)

```bash
curl http://localhost:8080/jobs
```

**ì‘ë‹µ:**
```json
[
  {
    "job_name": "iris-training-20250115-143022",
    "status": "Running",
    "created_at": "2025-01-15 14:30:22",
    "pods": []
  }
]
```

### Job ì‚­ì œ (DELETE)

```bash
curl -X DELETE http://localhost:8080/jobs/iris-training-20250115-143022
```

---

## ğŸ¯ ì‹¤ì „ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ê¸°ë³¸ ì‹¤í—˜

```
ëª©í‘œ: ê¸°ë³¸ íŒŒë¼ë¯¸í„°ë¡œ ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸

1. Training Controller UI ì ‘ì†
2. ê¸°ë³¸ê°’ ìœ ì§€ (n_estimators=100, max_depth=5)
3. ì‹¤í—˜ ì´ë¦„: "baseline"
4. í›ˆë ¨ ì‹œì‘
5. MLflowì—ì„œ ê²°ê³¼ í™•ì¸
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹

```
ëª©í‘œ: ì—¬ëŸ¬ ì¡°í•©ì„ í…ŒìŠ¤íŠ¸í•˜ì—¬ ìµœì  íŒŒë¼ë¯¸í„° ì°¾ê¸°

ì‹¤í—˜ 1:
- n_estimators: 100, max_depth: 5
- ì‹¤í—˜ ì´ë¦„: "exp-1-baseline"

ì‹¤í—˜ 2:
- n_estimators: 200, max_depth: 10
- ì‹¤í—˜ ì´ë¦„: "exp-2-more-trees"

ì‹¤í—˜ 3:
- n_estimators: 300, max_depth: 20
- ì‹¤í—˜ ì´ë¦„: "exp-3-deep"

â†’ MLflowì—ì„œ ë¹„êµí•˜ì—¬ ìµœê³  ì„±ëŠ¥ ì„ íƒ
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë³‘ë ¬ ì‹¤í—˜

```
ëª©í‘œ: ì—¬ëŸ¬ ì‹¤í—˜ì„ ë™ì‹œì— ì‹¤í–‰

1. UIì—ì„œ ì²« ë²ˆì§¸ ì‹¤í—˜ ì‹œì‘
2. ë°”ë¡œ ë‘ ë²ˆì§¸ ì‹¤í—˜ ì‹œì‘
3. ì„¸ ë²ˆì§¸ ì‹¤í—˜ ì‹œì‘
4. ì‹¤í–‰ ì¤‘ì¸ Job íŒ¨ë„ì—ì„œ ëª¨ë‘ í™•ì¸
5. MLflowì—ì„œ ê²°ê³¼ ë¹„êµ
```

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ì›¹ ë¸Œë¼ìš°ì €                   â”‚
â”‚    http://localhost:8080              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Training Controller (Pod)          â”‚
â”‚    - FastAPI                          â”‚
â”‚    - Kubernetes Python Client         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Kubernetes API Server              â”‚
â”‚    - Job ìƒì„±/ì¡°íšŒ/ì‚­ì œ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Training Job (Pod)                 â”‚
â”‚    - train_pipeline_mlflow.py         â”‚
â”‚    - MLflow ìë™ ì¶”ì                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    MLflow Server (Pod)                â”‚
â”‚    - ì‹¤í—˜ ë°ì´í„° ì €ì¥                 â”‚
â”‚    - UI ì œê³µ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### RBAC ê¶Œí•œ

Training ControllerëŠ” ë‹¤ìŒ ê¶Œí•œì„ ê°€ì§‘ë‹ˆë‹¤:

```yaml
- apiGroups: ["batch"]
  resources: ["jobs"]
  verbs: ["get", "list", "create", "delete", "watch"]
```

ì´ë¥¼ í†µí•´ ì•ˆì „í•˜ê²Œ Jobì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ”§ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### UI í¬íŠ¸ ë³€ê²½

```yaml
# k8s/06-training-controller.yaml
ports:
- containerPort: 8080  # ì›í•˜ëŠ” í¬íŠ¸ë¡œ ë³€ê²½
```

### ë¦¬ì†ŒìŠ¤ ì œí•œ ì¡°ì •

```yaml
# k8s/06-training-controller.yaml
resources:
  requests:
    cpu: "100m"
    memory: "256Mi"
  limits:
    cpu: "200m"
    memory: "512Mi"
```

### í›ˆë ¨ Job ê¸°ë³¸ê°’ ë³€ê²½

```python
# training-controller/main.py
class TrainingRequest(BaseModel):
    n_estimators: int = Field(default=200, ...)  # ê¸°ë³¸ê°’ ë³€ê²½
    max_depth: int = Field(default=10, ...)      # ê¸°ë³¸ê°’ ë³€ê²½
```

---

## ğŸ› ë¬¸ì œ í•´ê²°

### Q: UIì— ì ‘ì†ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤

**í™•ì¸:**
```bash
# Pod ìƒíƒœ í™•ì¸
kubectl get pods -n mlops-training -l app=training-controller

# ë¡œê·¸ í™•ì¸
kubectl logs -f deployment/training-controller -n mlops-training

# í¬íŠ¸í¬ì›Œë”© í™•ì¸
lsof -i :8080
```

### Q: Jobì´ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤

**í™•ì¸:**
```bash
# RBAC ê¶Œí•œ í™•ì¸
kubectl get rolebinding training-controller-binding -n mlops-training

# ServiceAccount í™•ì¸
kubectl get serviceaccount training-controller -n mlops-training

# Controller ë¡œê·¸ í™•ì¸
kubectl logs -f deployment/training-controller -n mlops-training
```

### Q: Jobì´ Pending ìƒíƒœë¡œ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤

**í™•ì¸:**
```bash
# Job ìƒì„¸ ì •ë³´
kubectl describe job <job-name> -n mlops-training

# ì¼ë°˜ì ì¸ ì›ì¸:
# - ë¦¬ì†ŒìŠ¤ ë¶€ì¡±
# - PVC ë°”ì¸ë”© ì‹¤íŒ¨
# - ì´ë¯¸ì§€ Pull ì‹¤íŒ¨
```

---

## ğŸ“ˆ ëª¨ë²” ì‚¬ë¡€

### 1. ì‹¤í—˜ ì´ë¦„ ê·œì¹™

```
baseline              # ê¸°ë³¸ ì‹¤í—˜
exp-{number}          # ìˆœì°¨ì  ì‹¤í—˜ (exp-1, exp-2, ...)
{feature}-v{version}  # ê¸°ëŠ¥ë³„ ë²„ì „ (deep-trees-v1)
{date}-{description}  # ë‚ ì§œ + ì„¤ëª… (20250115-optimized)
```

### 2. í•˜ì´í¼íŒŒë¼ë¯¸í„° ë²”ìœ„

| íŒŒë¼ë¯¸í„° | ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ | ì¼ë°˜ | ê³ ì„±ëŠ¥ |
|----------|------------|------|--------|
| `n_estimators` | 50-100 | 100-200 | 200-500 |
| `max_depth` | 3-5 | 5-10 | 10-20 |

### 3. ì‹¤í—˜ ì›Œí¬í”Œë¡œìš°

```
1. baseline ì‹¤í—˜ (ê¸°ë³¸ê°’)
   â†“
2. íŒŒë¼ë¯¸í„° ì¦ê°€ (n_estimators x2)
   â†“
3. ê¹Šì´ ì¡°ì • (max_depth +5)
   â†“
4. ìµœì  ì¡°í•© íƒìƒ‰
   â†“
5. ìµœì¢… ëª¨ë¸ ì„ íƒ (MLflowì—ì„œ ë¹„êµ)
```

---

## ğŸ”— ê´€ë ¨ ë§í¬

**ì›¹ UI:**
- Training Controller: http://localhost:8080
- MLflow UI: http://localhost:5000
- Serving API: http://localhost:8000/docs

**ë¬¸ì„œ:**
- [KUBERNETES.md](KUBERNETES.md) - Kubernetes í™˜ê²½ ê°œìš”
- [k8s/README.md](k8s/README.md) - ìƒì„¸ ìš´ì˜ ê°€ì´ë“œ
- [DEPLOYMENT.md](DEPLOYMENT.md) - GitHub Actions ë°°í¬

**ì½”ë“œ:**
- [training-controller/main.py](training-controller/main.py) - Controller API ì†ŒìŠ¤
- [k8s/06-training-controller.yaml](k8s/06-training-controller.yaml) - K8s ë§¤ë‹ˆí˜ìŠ¤íŠ¸

---

## ğŸ‰ ê²°ë¡ 

Training Controller UIë¥¼ ì‚¬ìš©í•˜ë©´:
- âœ… **í„°ë¯¸ë„ ëª…ë ¹ì–´ ì—†ì´** ë¸Œë¼ìš°ì €ì—ì„œ í›ˆë ¨ ì‹œì‘
- âœ… **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**ìœ¼ë¡œ Job ìƒíƒœ í™•ì¸
- âœ… **MLflowì™€ ìë™ ì—°ë™**ìœ¼ë¡œ ì‹¤í—˜ ì¶”ì 
- âœ… **ì—¬ëŸ¬ ì‹¤í—˜ì„ ë™ì‹œì—** ì‹¤í–‰í•˜ê³  ë¹„êµ

ì´ì œ í›ˆë ¨ì´ í›¨ì”¬ ì‰¬ì›Œì¡ŒìŠµë‹ˆë‹¤! ğŸš€

